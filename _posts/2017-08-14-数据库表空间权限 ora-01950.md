---
layout: post
title: 数据库表空间权限 ora-01950
category: oracle
---测试数据库某用户数据异常，授予dba权限排查异常，结束后回收dba权限。  
测试系统报错：ora-01950:对表空间XXX无权限。  
该表空间是该用户的默认表空间，并且该用户被授予resource权限。由此推断，应该是回收dba权限导致的报错，online documents上有一段话如下：  
When you grant the DBA and RESOURCE roles to a user or role with Oracle7 release 7.2.2 or later, the user or role is also granted the UNLIMITED TABLESPACE system privilege. When you revoke either role from a user or role, the UNLIMITED TABLESPACE system privilege is also revoked. The UNLIMITED TABLESPACE can also be revoked independent of the DBA and RESOURCE roles.  
所以revoke dba from user时，该用户的unlimited tablespace权限被同时收回。  

解决办法：  
alter user username quota umlimited  on  tablespacename;  

或者  grant  resource to username 也可以  

因为 grant resource to username 时 自动获得了有unlimited tablespace的系统权限  

划重点：  
revoke dba或者resource权限时，需要额外授予ulimited tablespace权限。    
另外：我们可以通过查看用户或者角色的权限来判断用户是否具备某种权限。

dba\_sys\_privs;  查看用户系统权限  
role\_sys\_privs; 查看角色具有的权限  
比如我要查看用户 wzsb的拥有的权限：  
SQL
> select * from dba_sys_privs where grantee='WZSB'
;

比如我要查看用户 wzsb的拥有的角色：  
SQL
> select * from dba_role_privs where grantee='WZSB'
;

查看一个用户所有的权限及角色  
select privilege from dba_sys_privs where grantee
='WZSB'

union
select privilege from dba_sys_privs where grantee in 
(select granted_role from dba_role_privs where grantee
='WZSB' ); 
