---
layout: post
title: Excel 常用函数
category: 数据分析
---

###1.vlookup（lookup\_value,table\_array,col\_index\_num,[range\_lookup]）  
lookup\_value:索引列  
table\_array:索引范围（绝对引用）  
col\_index\_num:目标索引列     
range\_lookup:精确搜索或者粗略搜索  
例如：  =VLOOKUP(H3,$A$3:$F$19,5,FALSE)
使用H3作为索引，在A3到F19区域内查找数据(第一列和索引数据进行匹配)，返回A3到F19区域第5列，使用精确搜索。

###2.countif(range,criteria)  
range:统计范围  
criteria: 统计条件  
例如：  =COUNTIF(A:A，A2)
A2单元格出现的次数（第n次）

###3.if(logical\_test,[value\_if\_true],[value\_if\_false])  
logical\_test:判断条件  
value\_if\_true:符合条件的操作  
value\_if\_false:不符合条件的操作  
例如： =IF(A2=“test”，0，1）
判断A2单元格内容是否等于test，如果等于标记为0，不等于标记为1

一般使用函数产生的结果数据出现错误，会用#N/A填充，如果需要判断结果是不是#N/A，使用ISNA函数，返回值为TRUE,或者FALSE；

###4.subtotal函数：
对筛选后的数据进行统计。  
唯一一个能统计用户可见单元格的函数。  
SUBTOTAL函数参数的含义 :

| function_num (包含手动隐藏)| Function_num（忽略手动隐藏） | 代表的函数意义 |
|:------------:|:------------:|:------------:|
| 1            |101           | AVERAGE      |
| 2            |102           | COUNT        |
| 3            |103           | COUNTA       |
| 4            |104           | MAX          |
| 5            |105           | MIN          |
| 6            |106           | PRODUCT      |
| 7            |107           | STDEV        |
| 8            |108           | STDEVP       |
| 9            |109           | SUM          |
| 10           |110           | VAR          |
| 11           |111           | VARP         |  

为筛选出来的数据添加连续序号：  
例如：=subtotal(3,$A$1:A2)-1，然后向下拉    
（计算A1到A2，不为空的单元格的数量）-1   
也就是当我们对数据进行删选后能得到连续序号。








 
 






