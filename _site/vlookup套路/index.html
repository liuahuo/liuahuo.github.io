<!DOCTYPE html> <html> <head> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.0.0 --> <title>vlookup的套路 - 曼达漫记</title> <meta property="og:title" content="vlookup的套路" /> <meta name="description" content="vlookup 常见错误类型#NAME？ 函数名称出现该错误，通常是函数名称中的字符错了、漏了、多了、顺序弄错了，或者函数参数中多了不该有的标点符号。#VALUE! 值错误vlookup中缺少返回值的参数时，就会出现该错误。#REF! 引用错误当函数中所引用的位置不存在时，会导致该错误。例如：引用的单元格、区域被删除#N/A 找不到数据当查找数据在被查找数据表中一定存在时，单元格格式不一致最可能导致该错误的出现。" /> <meta property="og:description" content="vlookup 常见错误类型#NAME？ 函数名称出现该错误，通常是函数名称中的字符错了、漏了、多了、顺序弄错了，或者函数参数中多了不该有的标点符号。#VALUE! 值错误vlookup中缺少返回值的参数时，就会出现该错误。#REF! 引用错误当函数中所引用的位置不存在时，会导致该错误。例如：引用的单元格、区域被删除#N/A 找不到数据当查找数据在被查找数据表中一定存在时，单元格格式不一致最可能导致该错误的出现。" /> <link rel="canonical" href="http://liuahuo.github.io/vlookup%E5%A5%97%E8%B7%AF/" /> <meta property="og:url" content="http://liuahuo.github.io/vlookup%E5%A5%97%E8%B7%AF/" /> <meta property="og:site_name" content="曼达漫记" /> <meta property="og:type" content="article" /> <meta property="article:published_time" content="2018-04-09T00:00:00+08:00" /> <script type="application/ld+json"> { "@context": "http://schema.org", "@type": "BlogPosting", "headline": "vlookup的套路", "datePublished": "2018-04-09T00:00:00+08:00", "description": "vlookup 常见错误类型#NAME？ 函数名称出现该错误，通常是函数名称中的字符错了、漏了、多了、顺序弄错了，或者函数参数中多了不该有的标点符号。#VALUE! 值错误vlookup中缺少返回值的参数时，就会出现该错误。#REF! 引用错误当函数中所引用的位置不存在时，会导致该错误。例如：引用的单元格、区域被删除#N/A 找不到数据当查找数据在被查找数据表中一定存在时，单元格格式不一致最可能导致该错误的出现。", "url": "http://liuahuo.github.io/vlookup%E5%A5%97%E8%B7%AF/" } </script> <!-- End Jekyll SEO tag --> <link href="https://fonts.googleapis.com/css?family=Alfa+Slab+One|Source+Serif+Pro" rel="stylesheet"> <link rel="stylesheet" href="/css/main.css"> <link rel="canonical" href="http://liuahuo.github.io/vlookup%E5%A5%97%E8%B7%AF/"> <link rel="alternate" type="application/rss+xml" title="曼达漫记" href="http://liuahuo.github.io/feed.xml"> </head> <body> <div class="wrapper"> <div class="color-bars-header"><div class="cor-head colr-1"></div><div class="cor-head colr-2"></div><div class="cor-head colr-3"></div><div class="cor-head colr-4"></div><div class="cor-head colr-1"></div><div class="cor-head colr-2"></div><div class="cor-head colr-3"></div><div class="cor-head colr-4"></div></div> <style>.color-bars-header{font-size:0}.cor-head{width:12.5%;height:8px;display:inline-block}.colr-1{background-color:#98C1D9}.colr-2{background-color:#F3DE8A}.colr-3{background-color:#A7D3A6}.colr-4{background-color:#EB9486}@media screen and (max-width: 800px){.color-bars-header{margin: 0 -15px}}</style> <header class="site-header"> <div class="wrapper"> <a href="/"><h1 class="site-title">曼达漫记</h1></a> <nav class="site-nav"> <a href="/" class="nav-link">首页</a> <a href="/category/" class="nav-link">分类</a> <a href="/contact/" class="nav-link">联系</a> </nav> </div> </header> </div> <div class="page-content"> <div class="wrapper"> <article class="post" itemscope itemtype="http://schema.org/BlogPosting"> <header class="post-header"> <h1 class="post-title" itemprop="name headline">vlookup的套路</h1> <p class="post-meta"><time datetime="2018-04-09T00:00:00+08:00" itemprop="datePublished">Apr 9, 2018</time></p> </header> <div class="post-content" itemprop="articleBody"> <h3 id="vlookup-">vlookup 常见错误类型</h3> <p>#NAME？ 函数名称<br /> 出现该错误，通常是函数名称中的字符错了、漏了、多了、顺序弄错了，或者函数参数中多了不该有的标点符号。<br /> #VALUE! 值错误<br /> vlookup中缺少返回值的参数时，就会出现该错误。<br /> #REF! 引用错误<br /> 当函数中所引用的位置不存在时，会导致该错误。例如：引用的单元格、区域被删除<br /> #N/A 找不到数据 当查找数据在被查找数据表中一定存在时，单元格格式不一致最可能导致该错误的出现。</p> <p>###实现vlookup查找返回多列值：借助match函数<br /> match 函数：match函数用于查找对象在一组数据中的具体位置，返回一个数值结果。<br /> match(lookup_value,lookup_array,match_type)<br /> vlookup+match 完成查找返回多列的功能 在vlookup查找时，根据一个查找条件，查找多列并返回，不需要一个一个写<br /> vlookup（lookup_value,table_array,col_index_num,[range_lookup]）<br /> col_index_num——&gt;自动填写 例如： vlookup（lookup_value,table_array,match(lookup_value,array,match_type),[range_lookup]）<br /> <img src="/images/vlookup/vlookup多列查询.png" alt="vlookup查询返回多列" /></p> <p>###实现vlookup函数按多条件查询数据： 借助连接函数 <img src="/images/vlookup/vlookup多查询条件.png" alt="vlookup多条件查询" /><br /> 例如：通过客户编号和订单编号查询订单金额。 <br /> 在查询条件之间连接上“@”，是为了区分似“100”&amp;“01”和“10”&amp;“001”之间的区别，以保证查询结果正确。<br /> 这个公式的思路与用vlookup函数进行逆向查询的私立一样，都是使用IF函数对查询数据进行整理，使其符合vlookup函数的查询需求。<br /> 特别地：写完该函数后需要使用ctrl+shift+enter键，因为该函数为数组函数。</p> <p>###实现vlookup反向查询方法1：借助index和match函数 index+match函数组合<br /> index函数：index函数在给定的区域内，返回第几行第几列的值。 index(array,row_num,column_num)<br /> index+match 完成反查找的功能<br /> 例如：index(array,match(lookup_value,array,match_type),column_num) 行和列其实都可以使用match函数进行定位，例子中写的是行按照match函数定位<br /> <img src="/images/vlookup/vlookup反向查找1.png" alt="vlookup反向查找" /></p> <p>###实现vlookup反向查找方法2：<br /> <img src="/images/vlookup/vlookup反向查找.png" alt="vlookup反向查找" /> <br /> 例如：通过学号查找姓名。<br /> 通过if函数完成b1：b4和a1：a4两列数据的位置调换if({true,false},b1:b4,a1:a4)相当于 if(true,b1:b4,a1:a4) if(false,b1:b4,a1:a4)， if函数的结果为：b1:b4,a1:a4。 由此，vlookup查找的数据范围变成了b1:b4,a1:a4列，即可完成按照学号完成姓名查找的功能。</p> </div> </article> <!----> <div id="disqus_thread"></div> <script defer> (function() { var d = document, s = d.createElement('script'); s.src = '//webjeda-demo.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); </script> <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript> <!----> <!--<h2> 分类 </h2> <ul class="category-list"> <li> <a href="/categories/docker"> docker (4) </a> </li> <li> <a href="/categories/linux"> linux (1) </a> </li> <li> <a href="/categories/git"> git (1) </a> </li> <li> <a href="/categories/大数据"> 大数据 (1) </a> </li> <li> <a href="/categories/oracle"> oracle (4) </a> </li> <li style="background-color: #444"> <a href="/categories/数据分析"> 数据分析 (3) </a> </li> <li> <a href="/categories/sql语句"> sql语句 (2) </a> </li> <li> <a href="/categories/markdown语法"> markdown语法 (1) </a> </li> </ul>--> </div> </div> <div class="wrapper"> <footer class="site-footer"> <div class="wrapper"> </div> </footer> <div class="color-bars-header"><div class="cor-head colr-1"></div><div class="cor-head colr-2"></div><div class="cor-head colr-3"></div><div class="cor-head colr-4"></div><div class="cor-head colr-1"></div><div class="cor-head colr-2"></div><div class="cor-head colr-3"></div><div class="cor-head colr-4"></div></div> </div> <!-- Google Analytics Tracking code --> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-83979019-1', 'auto'); ga('send', 'pageview'); </script> </body> </html>
