<!DOCTYPE html> <html> <head> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.0.0 --> <title>进入docker容器的方法 - I’m Amanda</title> <meta property="og:title" content="进入docker容器的方法" /> <meta name="description" content=" 登陆容器的方式 ssh登录 第三方工具(nsenter、nsinit) docker提供的工具(attach、exec) 优点 符合平时登录服务器习惯，不用额外学习 使用方便快捷 使用方便快捷 缺点 1.秘钥管理2.ssh升级3.监控 1.需要学习第三方工具使用规则2.docker宿主机root权限 1.使用attach登录容器，exit退出容器2.docker宿主机root权限3.同屏 适用范围 1.适用docker宿主机登录至容器内部2.远程登录该容器 适用docker宿主机登录至容器内部 适用docker宿主机登录至容器内部 " /> <meta property="og:description" content=" 登陆容器的方式 ssh登录 第三方工具(nsenter、nsinit) docker提供的工具(attach、exec) 优点 符合平时登录服务器习惯，不用额外学习 使用方便快捷 使用方便快捷 缺点 1.秘钥管理2.ssh升级3.监控 1.需要学习第三方工具使用规则2.docker宿主机root权限 1.使用attach登录容器，exit退出容器2.docker宿主机root权限3.同屏 适用范围 1.适用docker宿主机登录至容器内部2.远程登录该容器 适用docker宿主机登录至容器内部 适用docker宿主机登录至容器内部 " /> <link rel="canonical" href="http://localhost:4000/How-to-enter-docker/" /> <meta property="og:url" content="http://localhost:4000/How-to-enter-docker/" /> <meta property="og:site_name" content="I’m Amanda" /> <meta property="og:type" content="article" /> <meta property="article:published_time" content="2016-08-18T00:00:00+08:00" /> <script type="application/ld+json"> { "@context": "http://schema.org", "@type": "BlogPosting", "headline": "进入docker容器的方法", "datePublished": "2016-08-18T00:00:00+08:00", "description": " 登陆容器的方式 ssh登录 第三方工具(nsenter、nsinit) docker提供的工具(attach、exec) 优点 符合平时登录服务器习惯，不用额外学习 使用方便快捷 使用方便快捷 缺点 1.秘钥管理2.ssh升级3.监控 1.需要学习第三方工具使用规则2.docker宿主机root权限 1.使用attach登录容器，exit退出容器2.docker宿主机root权限3.同屏 适用范围 1.适用docker宿主机登录至容器内部2.远程登录该容器 适用docker宿主机登录至容器内部 适用docker宿主机登录至容器内部 ", "url": "http://localhost:4000/How-to-enter-docker/" } </script> <!-- End Jekyll SEO tag --> <link href="https://fonts.googleapis.com/css?family=Alfa+Slab+One|Source+Serif+Pro" rel="stylesheet"> <link rel="stylesheet" href="/css/main.css"> <link rel="canonical" href="http://localhost:4000/How-to-enter-docker/"> <link rel="alternate" type="application/rss+xml" title="I'm Amanda" href="http://localhost:4000/feed.xml"> </head> <body> <div class="wrapper"> <div class="color-bars-header"><div class="cor-head colr-1"></div><div class="cor-head colr-2"></div><div class="cor-head colr-3"></div><div class="cor-head colr-4"></div><div class="cor-head colr-1"></div><div class="cor-head colr-2"></div><div class="cor-head colr-3"></div><div class="cor-head colr-4"></div></div> <style>.color-bars-header{font-size:0}.cor-head{width:12.5%;height:8px;display:inline-block}.colr-1{background-color:#98C1D9}.colr-2{background-color:#F3DE8A}.colr-3{background-color:#A7D3A6}.colr-4{background-color:#EB9486}@media screen and (max-width: 800px){.color-bars-header{margin: 0 -15px}}</style> <header class="site-header"> <div class="wrapper"> <a href="/"><h1 class="site-title">I'm Amanda</h1></a> <nav class="site-nav"> <a href="/" class="nav-link">首页</a> <a href="/category/" class="nav-link">分类</a> <a href="/contact/" class="nav-link">联系</a> </nav> </div> </header> </div> <div class="page-content"> <div class="wrapper"> <article class="post" itemscope itemtype="http://schema.org/BlogPosting"> <header class="post-header"> <h1 class="post-title" itemprop="name headline">进入docker容器的方法</h1> <p class="post-meta"><time datetime="2016-08-18T00:00:00+08:00" itemprop="datePublished">Aug 18, 2016</time></p> </header> <div class="post-content" itemprop="articleBody"> <table> <thead> <tr> <th>登陆容器的方式</th> <th style="text-align: center">ssh登录</th> <th style="text-align: right">第三方工具(nsenter、nsinit)</th> <th style="text-align: right">docker提供的工具(attach、exec)</th> </tr> </thead> <tbody> <tr> <td>优点</td> <td style="text-align: center">符合平时登录服务器习惯，不用额外学习</td> <td style="text-align: right">使用方便快捷</td> <td style="text-align: right">使用方便快捷</td> </tr> <tr> <td>缺点</td> <td style="text-align: center">1.秘钥管理2.ssh升级3.监控</td> <td style="text-align: right">1.需要学习第三方工具使用规则2.docker宿主机root权限</td> <td style="text-align: right">1.使用attach登录容器，exit退出容器2.docker宿主机root权限3.同屏</td> </tr> <tr> <td>适用范围</td> <td style="text-align: center">1.适用docker宿主机登录至容器内部2.远程登录该容器</td> <td style="text-align: right">适用docker宿主机登录至容器内部</td> <td style="text-align: right">适用docker宿主机登录至容器内部</td> </tr> </tbody> </table> <h2 id="ssh">SSH</h2> <p>使用方法： ssh 用户@IP地址 -p 端口 一般ssh登录走22端口，但是在docker中bridge网络模式使用NAT做端口映射，端口需要特殊标注</p> <p>适用范围：docker宿主机内部登录容器，外部终端直接登录容器</p> <p>优点：符合管理员、开发者登录服务器的习惯，不需要进行额外的学习</p> <p>缺点：</p> <ul> <li>1.秘钥管理 如果将秘钥写到镜像中，当需要更新秘钥时需要重新制作镜像，部署，重启容器，虽然这个步骤繁琐，但是个人认为还是安全的。如果将秘钥写到卷中，首先要保证该容器没有这个卷的写权限，否则存在秘钥被篡改的风险。</li> <li>2.ssh升级或打补丁 ssh有漏洞或者版本升级时，需要对每一个容器进行打补丁或者升级操作</li> </ul> <h2 id="nsenter">nsenter工具</h2> <p>nsenter工具的安装：</p> <p>wget https://www.kernel.org/pub/linux/utils/util-linux/v2.28/util-linux-2.28.tar.gz</p> <p>tar -xzvf util-linux-2.28.tar.gz</p> <p>cd util-linux-2.28 ./configure –without-ncurses</p> <p>make nsenter</p> <p>cp nsenter /usr/local/bin</p> <p>安装完成后，使用nsenter —help 命令查看，可以看到使用方法及参数则证明安装成功。</p> <p><img src="/images/enter-docker/nsenter-option.png" alt="nsenter-option" /></p> <p>使用nsenter 命令登录docker 容器</p> <p><img src="/images/enter-docker/nsenter.png" alt="nsenter-option" /></p> <p>在使用nsenter登录docker 容器时，一般使用前6个参数(我看别人都这么写的，想了想原因，可能使用前6个参数就可以涵盖网络，磁盘，进程管理操作系统基本的信息，我尝试只使用其中一个或几个参数登录容器，成功了但是操作系统功能使用上受限制，比如无法使用网络配置功能等)。</p> <h2 id="docker-attach">docker attach</h2> <p>使用方法：docker attach [container name]</p> <p>适用范围：docker宿主机内部登录容器</p> <p>优点：快捷方便</p> <p>缺点：</p> <ul> <li>1.exit后直接退出该container</li> <li>2.多屏同步 这相当于同一时间最多只能有一个终端连接容器</li> </ul> <p><img src="/images/enter-docker/attach.png" alt="attach" /></p> <p><img src="/images/enter-docker/attach-same-screen.png" alt="attach same screen" /></p> <h2 id="docker-exec">docker exec</h2> <p>使用方法：docker exec -it [container name] [command]</p> <p>适用范围：docker宿主机内部登录容器</p> <p>优点：快捷方便</p> <p>缺点：外部终端无法使用这种方法登录容器</p> <p>使用参数介绍：</p> <p>-i, –interactive Keep STDIN open even if not attached ————交互</p> <p>-t, –tty Allocate a pseudo-TTY————分配伪终端</p> <p>一般情况会使用-it这个组合命令，如果单用也只能单独使用-i命令</p> <p>-i 参数不会产生伪终端，但是会有正确的返回</p> <p><img src="/images/enter-docker/exec.png" alt="attach same screen" /></p> <p>使用-it时，则和我们平常操作console界面类似。而且也不会像attach方式因为退出，导致整个容器退出。这种方式可以替代ssh或者nsenter、nsinit方式，在容器内进行操作。</p> </div> </article> <!----> <div id="disqus_thread"></div> <script defer> (function() { var d = document, s = d.createElement('script'); s.src = '//webjeda-demo.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); </script> <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript> <!----> <!--<h2> 分类 </h2> <ul class="category-list"> <li style="background-color: #444"> <a href="/categories/docker"> docker (4) </a> </li> <li> <a href="/categories/linux"> linux (1) </a> </li> <li> <a href="/categories/git"> git (1) </a> </li> <li> <a href="/categories/大数据"> 大数据 (1) </a> </li> <li> <a href="/categories/oracle"> oracle (4) </a> </li> <li> <a href="/categories/数据分析"> 数据分析 (2) </a> </li> <li> <a href="/categories/sql语句"> sql语句 (2) </a> </li> </ul>--> </div> </div> <div class="wrapper"> <footer class="site-footer"> <div class="wrapper"> </div> </footer> <div class="color-bars-header"><div class="cor-head colr-1"></div><div class="cor-head colr-2"></div><div class="cor-head colr-3"></div><div class="cor-head colr-4"></div><div class="cor-head colr-1"></div><div class="cor-head colr-2"></div><div class="cor-head colr-3"></div><div class="cor-head colr-4"></div></div> </div> <!-- Google Analytics Tracking code --> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-83979019-1', 'auto'); ga('send', 'pageview'); </script> </body> </html>
